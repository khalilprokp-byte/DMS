<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ† - Professional Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap');
        
        * { 
            font-family: 'Cairo', 'Segoe UI', sans-serif; 
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }
        
        .sidebar { 
            width: 280px; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: linear-gradient(180deg, #1e3c72 0%, #2a5298 100%);
            box-shadow: 4px 0 12px rgba(0,0,0,0.1);
        }
        
        .main-content { 
            margin-right: 280px; 
            transition: all 0.3s;
        }
        
        @media (max-width: 768px) {
            .sidebar { 
                transform: translateX(100%); 
                position: fixed; 
                right: 0; 
                z-index: 50; 
                height: 100vh; 
            }
            .sidebar.open { transform: translateX(0); }
            .main-content { margin-right: 0; }
        }
        
        .card { 
            background: white; 
            border-radius: 16px; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.08); 
            padding: 1.75rem; 
            transition: all 0.3s;
            border: 1px solid rgba(0,0,0,0.05);
        }
        
        .card:hover {
            box-shadow: 0 8px 30px rgba(0,0,0,0.12);
            transform: translateY(-2px);
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
        }
        
        .stat-card-green {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }
        
        .stat-card-blue {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .stat-card-orange {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }
        
        .btn { 
            padding: 0.75rem 1.5rem; 
            border-radius: 10px; 
            font-weight: 600; 
            cursor: pointer; 
            transition: all 0.3s;
            border: none;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        
        .btn-primary { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; 
        }
        
        .btn-success { 
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white; 
        }
        
        .btn-danger { 
            background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
            color: white; 
        }
        
        .btn-secondary { 
            background: linear-gradient(135deg, #868f96 0%, #596164 100%);
            color: white; 
        }
        
        .badge { 
            padding: 0.35rem 0.85rem; 
            border-radius: 20px; 
            font-size: 0.75rem; 
            font-weight: 600;
            letter-spacing: 0.5px;
        }
        
        .badge-success { background: #d1fae5; color: #065f46; }
        .badge-warning { background: #fef3c7; color: #92400e; }
        .badge-danger { background: #fee2e2; color: #991b1b; }
        .badge-info { background: #dbeafe; color: #1e40af; }
        
        .input { 
            width: 100%; 
            padding: 0.75rem 1.25rem; 
            border: 2px solid #e5e7eb; 
            border-radius: 10px;
            transition: all 0.3s;
            font-size: 0.95rem;
        }
        
        .input:focus { 
            outline: none; 
            border-color: #667eea; 
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .modal { 
            display: none; 
            position: fixed; 
            inset: 0; 
            background: rgba(0,0,0,0.6); 
            z-index: 100; 
            align-items: center; 
            justify-content: center;
            backdrop-filter: blur(4px);
        }
        
        .modal.active { display: flex; }
        
        .modal-content { 
            background: white; 
            border-radius: 20px; 
            max-width: 90%; 
            max-height: 90vh; 
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .hidden { display: none !important; }
        
        .nav-item {
            color: rgba(255,255,255,0.8);
            transition: all 0.3s;
            border-radius: 10px;
        }
        
        .nav-item:hover {
            background: rgba(255,255,255,0.1);
            color: white;
        }
        
        .nav-item.active {
            background: rgba(255,255,255,0.2);
            color: white;
        }
        
        .table-row {
            transition: all 0.2s;
        }
        
        .table-row:hover {
            background: #f9fafb;
            transform: scale(1.01);
        }
        
        .page-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            border-radius: 16px;
            margin-bottom: 2rem;
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.3);
        }
        
        .stat-icon {
            font-size: 3.5rem;
            opacity: 0.9;
        }
        
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div id="sidebar" class="sidebar fixed top-0 bottom-0 right-0">
        <div class="p-6 border-b border-white border-opacity-20">
            <h1 class="text-2xl font-bold text-white">Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†</h1>
            <p class="text-sm text-white text-opacity-70 mt-1">Professional Edition</p>
        </div>
        <nav class="p-4">
            <a href="#" onclick="showPage('dashboard')" class="nav-item active flex items-center gap-3 p-3 mb-2" data-page="dashboard">
                <span class="text-2xl">ğŸ“Š</span> 
                <span class="text-base">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</span>
            </a>
            <a href="#" onclick="showPage('drivers')" class="nav-item flex items-center gap-3 p-3 mb-2" data-page="drivers">
                <span class="text-2xl">ğŸ‘¥</span> 
                <span class="text-base">Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†</span>
            </a>
            <a href="#" onclick="showPage('companies')" class="nav-item flex items-center gap-3 p-3 mb-2" data-page="companies">
                <span class="text-2xl">ğŸ¢</span> 
                <span class="text-base">Ø§Ù„Ø´Ø±ÙƒØ§Øª</span>
            </a>
            <a href="#" onclick="showPage('orders')" class="nav-item flex items-center gap-3 p-3 mb-2" data-page="orders">
                <span class="text-2xl">ğŸ“¦</span> 
                <span class="text-base">Ø§Ù„Ø·Ù„Ø¨Ø§Øª</span>
            </a>
            <a href="#" onclick="showPage('salaries')" class="nav-item flex items-center gap-3 p-3 mb-2" data-page="salaries">
                <span class="text-2xl">ğŸ’°</span> 
                <span class="text-base">Ø§Ù„Ø±ÙˆØ§ØªØ¨</span>
            </a>
            <a href="#" onclick="showPage('advances')" class="nav-item flex items-center gap-3 p-3 mb-2" data-page="advances">
                <span class="text-2xl">ğŸ’³</span> 
                <span class="text-base">Ø§Ù„Ø³Ù„Ù</span>
            </a>
            <a href="#" onclick="showPage('reports')" class="nav-item flex items-center gap-3 p-3 mb-2" data-page="reports">
                <span class="text-2xl">ğŸ“„</span> 
                <span class="text-base">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</span>
            </a>
        </nav>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Header -->
        <div class="bg-white shadow-sm p-5 flex items-center justify-between sticky top-0 z-40">
            <button onclick="toggleSidebar()" class="md:hidden p-2 hover:bg-gray-100 rounded-lg transition">
                <span class="text-2xl">â˜°</span>
            </button>
            <div class="flex items-center gap-6">
                <div class="text-right">
                    <p class="text-sm font-semibold text-gray-800">Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ 51ØŒ 2024</p>
                    <p class="text-xs text-gray-500">Ø¯ÙŠØ³Ù…Ø¨Ø± 24ØŒ 2024</p>
                </div>
                <div class="flex items-center gap-2 bg-gradient-to-r from-purple-500 to-indigo-600 text-white px-4 py-2 rounded-full">
                    <span class="text-sm font-semibold">Admin</span>
                    <span class="text-lg">ğŸ‘¤</span>
                </div>
            </div>
        </div>

        <!-- Pages Container -->
        <div id="pages-container" class="p-8">
            
            <!-- Dashboard Page -->
            <div id="dashboard-page" class="page">
                <div class="page-header">
                    <h2 class="text-4xl font-bold mb-2">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>
                    <p class="text-lg opacity-90">Ù†Ø¸Ø±Ø© Ø´Ø§Ù…Ù„Ø© Ø¹Ù„Ù‰ Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù†Ø¸Ø§Ù…</p>
                </div>
                
                <!-- Main Stats Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="card stat-card">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm opacity-90 mb-1">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</p>
                                <p class="text-3xl font-bold" id="total-revenue">Â£0</p>
                                <p class="text-xs opacity-75 mt-2">Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</p>
                            </div>
                            <span class="stat-icon">ğŸ’°</span>
                        </div>
                    </div>
                    
                    <div class="card stat-card-green">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm opacity-90 mb-1">Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø±ÙˆØ§ØªØ¨</p>
                                <p class="text-3xl font-bold" id="total-salaries">Â£0</p>
                                <p class="text-xs opacity-75 mt-2">Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø© Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</p>
                            </div>
                            <span class="stat-icon">ğŸ’µ</span>
                        </div>
                    </div>
                    
                    <div class="card stat-card-blue">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm opacity-90 mb-1">ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­</p>
                                <p class="text-3xl font-bold" id="net-profit">Â£0</p>
                                <p class="text-xs opacity-75 mt-2">Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª - Ø§Ù„Ø±ÙˆØ§ØªØ¨</p>
                            </div>
                            <span class="stat-icon">ğŸ“ˆ</span>
                        </div>
                    </div>
                    
                    <div class="card stat-card-orange">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm opacity-90 mb-1">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</p>
                                <p class="text-3xl font-bold" id="total-orders">0</p>
                                <p class="text-xs opacity-75 mt-2">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø³Ø¬Ù„Ø©</p>
                            </div>
                            <span class="stat-icon">ğŸ“¦</span>
                        </div>
                    </div>
                </div>

                <!-- Secondary Stats -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="card bg-green-50 border-2 border-green-200">
                        <div class="flex items-center gap-4">
                            <div class="text-4xl">âœ…</div>
                            <div>
                                <p class="text-sm text-green-700 font-semibold">Ø³Ø§Ø¦Ù‚ÙŠÙ† Ù†Ø´Ø·ÙŠÙ†</p>
                                <p class="text-3xl font-bold text-green-800" id="active-drivers">0</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card bg-yellow-50 border-2 border-yellow-200">
                        <div class="flex items-center gap-4">
                            <div class="text-4xl">ğŸ“</div>
                            <div>
                                <p class="text-sm text-yellow-700 font-semibold">ØªØ­Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨</p>
                                <p class="text-3xl font-bold text-yellow-800" id="training-drivers">0</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card bg-blue-50 border-2 border-blue-200">
                        <div class="flex items-center gap-4">
                            <div class="text-4xl">ğŸ¢</div>
                            <div>
                                <p class="text-sm text-blue-700 font-semibold">Ø´Ø±ÙƒØ§Øª Ù†Ø´Ø·Ø©</p>
                                <p class="text-3xl font-bold text-blue-800" id="active-companies">0</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card bg-purple-50 border-2 border-purple-200">
                        <div class="flex items-center gap-4">
                            <div class="text-4xl">âœ“</div>
                            <div>
                                <p class="text-sm text-purple-700 font-semibold">Ø·Ù„Ø¨Ø§Øª Ù…ÙƒØªÙ…Ù„Ø©</p>
                                <p class="text-3xl font-bold text-purple-800" id="completed-orders">0</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity & Quick Stats -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="card">
                        <h3 class="text-xl font-bold mb-4 pb-3 border-b-2 border-gray-100">Ø¢Ø®Ø± Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª</h3>
                        <div id="recent-activity" class="space-y-3"></div>
                    </div>
                    
                    <div class="card">
                        <h3 class="text-xl font-bold mb-4 pb-3 border-b-2 border-gray-100">Ù…Ù„Ø®Øµ Ø³Ø±ÙŠØ¹</h3>
                        <div class="space-y-4">
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                <span class="font-semibold text-gray-700">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª/Ø·Ù„Ø¨</span>
                                <span class="text-xl font-bold text-blue-600" id="avg-revenue">Â£0</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                <span class="font-semibold text-gray-700">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø·Ù„Ø¨Ø§Øª/Ø³Ø§Ø¦Ù‚</span>
                                <span class="text-xl font-bold text-green-600" id="avg-orders">0</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                <span class="font-semibold text-gray-700">Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­</span>
                                <span class="text-xl font-bold text-purple-600" id="profit-margin">0%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Drivers Page -->
            <div id="drivers-page" class="page hidden">
                <div class="page-header">
                    <div class="flex justify-between items-center">
                        <div>
                            <h2 class="text-4xl font-bold mb-2">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†</h2>
                            <p class="text-lg opacity-90">Ø¥Ø¯Ø§Ø±Ø© ÙˆØªØªØ¨Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†</p>
                        </div>
                        <button onclick="openDriverModal()" class="btn btn-success text-lg">
                            â• Ø¥Ø¶Ø§ÙØ© Ø³Ø§Ø¦Ù‚ Ø¬Ø¯ÙŠØ¯
                        </button>
                    </div>
                </div>

                <!-- Driver Stats -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                    <div class="card bg-gradient-to-br from-green-400 to-green-600 text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm opacity-90">Ù†Ø´Ø·ÙŠÙ†</p>
                                <p class="text-4xl font-bold" id="drivers-active">0</p>
                            </div>
                            <span class="text-5xl opacity-80">âœ…</span>
                        </div>
                    </div>
                    <div class="card bg-gradient-to-br from-yellow-400 to-yellow-600 text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm opacity-90">ØªØ¯Ø±ÙŠØ¨</p>
                                <p class="text-4xl font-bold" id="drivers-training">0</p>
                            </div>
                            <span class="text-5xl opacity-80">ğŸ“</span>
                        </div>
                    </div>
                    <div class="card bg-gradient-to-br from-red-400 to-red-600 text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm opacity-90">Ù…ÙˆÙ‚ÙˆÙÙŠÙ†</p>
                                <p class="text-4xl font-bold" id="drivers-suspended">0</p>
                            </div>
                            <span class="text-5xl opacity-80">â›”</span>
                        </div>
                    </div>
                </div>

                <!-- Search -->
                <div class="card mb-6 bg-gradient-to-r from-blue-50 to-purple-50">
                    <div class="flex items-center gap-3">
                        <span class="text-2xl">ğŸ”</span>
                        <input type="text" id="driver-search" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø³Ø§Ø¦Ù‚ Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ..." class="input flex-1 bg-white" onkeyup="filterDrivers()">
                    </div>
                </div>

                <!-- Drivers List -->
                <div class="card">
                    <h3 class="text-xl font-bold mb-4 pb-3 border-b-2">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†</h3>
                    <div id="drivers-list" class="space-y-4"></div>
                </div>
            </div>

            <!-- Companies Page -->
            <div id="companies-page" class="page hidden">
                <div class="page-header">
                    <div class="flex justify-between items-center">
                        <div>
                            <h2 class="text-4xl font-bold mb-2">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø´Ø±ÙƒØ§Øª</h2>
                            <p class="text-lg opacity-90">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø´Ø±ÙƒØ§Øª Ø§Ù„Ù…ØªØ¹Ø§Ù‚Ø¯Ø©</p>
                        </div>
                        <button onclick="openCompanyModal()" class="btn btn-success text-lg">
                            â• Ø¥Ø¶Ø§ÙØ© Ø´Ø±ÙƒØ© Ø¬Ø¯ÙŠØ¯Ø©
                        </button>
                    </div>
                </div>

                <!-- Companies List -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="companies-list"></div>
            </div>

            <!-- Orders Page -->
            <div id="orders-page" class="page hidden">
                <div class="page-header">
                    <div class="flex justify-between items-center">
                        <div>
                            <h2 class="text-4xl font-bold mb-2">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h2>
                            <p class="text-lg opacity-90">ØªØªØ¨Ø¹ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</p>
                        </div>
                        <button onclick="openOrderModal()" class="btn btn-success text-lg">
                            â• Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯
                        </button>
                    </div>
                </div>

                <!-- Order Stats -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                    <div class="card bg-gradient-to-br from-blue-400 to-blue-600 text-white">
                        <p class="text-sm opacity-90">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</p>
                        <p class="text-4xl font-bold" id="orders-total">0</p>
                    </div>
                    <div class="card bg-gradient-to-br from-green-400 to-green-600 text-white">
                        <p class="text-sm opacity-90">Ù…ÙƒØªÙ…Ù„Ø©</p>
                        <p class="text-4xl font-bold" id="orders-completed">0</p>
                    </div>
                    <div class="card bg-gradient-to-br from-yellow-400 to-yellow-600 text-white">
                        <p class="text-sm opacity-90">Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°</p>
                        <p class="text-4xl font-bold" id="orders-progress">0</p>
                    </div>
                    <div class="card bg-gradient-to-br from-purple-400 to-purple-600 text-white">
                        <p class="text-sm opacity-90">Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</p>
                        <p class="text-4xl font-bold" id="orders-revenue">Â£0</p>
                    </div>
                </div>

                <!-- Orders Table -->
                <div class="card overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gradient-to-r from-blue-500 to-purple-600 text-white">
                            <tr>
                                <th class="p-4 text-right font-bold">Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</th>
                                <th class="p-4 text-right font-bold">Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                                <th class="p-4 text-right font-bold">Ø§Ù„Ø´Ø±ÙƒØ©</th>
                                <th class="p-4 text-right font-bold">Ø§Ù„Ø³Ø§Ø¦Ù‚</th>
                                <th class="p-4 text-right font-bold">Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
                                <th class="p-4 text-right font-bold">Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</th>
                                <th class="p-4 text-right font-bold">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                <th class="p-4 text-right font-bold">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="orders-list"></tbody>
                    </table>
                </div>
            </div>

            <!-- Salaries Page -->
            <div id="salaries-page" class="page hidden">
                <div class="page-header">
                    <div class="flex justify-between items-center">
                        <div>
                            <h2 class="text-4xl font-bold mb-2">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±ÙˆØ§ØªØ¨</h2>
                            <p class="text-lg opacity-90">Ø­Ø³Ø§Ø¨ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø±ÙˆØ§ØªØ¨ Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†</p>
                        </div>
                        <button onclick="calculateWeeklySalaries()" class="btn btn-success text-lg">
                            ğŸ§® Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±ÙˆØ§ØªØ¨ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©
                        </button>
                    </div>
                </div>

                <!-- Salary Summary -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                    <div class="card bg-gradient-to-br from-indigo-400 to-indigo-600 text-white">
                        <p class="text-sm opacity-90">Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø­Ø§Ù„ÙŠ</p>
                        <p class="text-3xl font-bold">Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ 51</p>
                    </div>
                    <div class="card bg-gradient-to-br from-green-400 to-green-600 text-white">
                        <p class="text-sm opacity-90">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§ØªØ¨</p>
                        <p class="text-3xl font-bold" id="salaries-total">Â£0</p>
                    </div>
                    <div class="card bg-gradient-to-br from-yellow-400 to-yellow-600 text-white">
                        <p class="text-sm opacity-90">Ø§Ù„Ø¨ÙˆÙ†Øµ</p>
                        <p class="text-3xl font-bold" id="salaries-bonus">Â£0</p>
                    </div>
                    <div class="card bg-gradient-to-br from-red-400 to-red-600 text-white">
                        <p class="text-sm opacity-90">Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª</p>
                        <p class="text-3xl font-bold" id="salaries-deductions">Â£0</p>
                    </div>
                </div>

                <!-- Salaries List -->
                <div class="card">
                    <h3 class="text-xl font-bold mb-4 pb-3 border-b-2">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø±ÙˆØ§ØªØ¨</h3>
                    <div id="salaries-list" class="space-y-4"></div>
                </div>
            </div>

            <!-- Advances Page -->
            <div id="advances-page" class="page hidden">
                <div class="page-header">
                    <div class="flex justify-between items-center">
                        <div>
                            <h2 class="text-4xl font-bold mb-2">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø³Ù„Ù</h2>
                            <p class="text-lg opacity-90">ØªØªØ¨Ø¹ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø³Ù„Ù ÙˆØ§Ù„Ù‚Ø±ÙˆØ¶</p>
                        </div>
                        <button onclick="openAdvanceModal()" class="btn btn-success text-lg">
                            â• Ø¥Ø¶Ø§ÙØ© Ø³Ù„ÙØ© Ø¬Ø¯ÙŠØ¯Ø©
                        </button>
                    </div>
                </div>

                <!-- Advance Stats -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                    <div class="card bg-gradient-to-br from-orange-400 to-orange-600 text-white">
                        <p class="text-sm opacity-90">Ø³Ù„Ù Ù†Ø´Ø·Ø©</p>
                        <p class="text-4xl font-bold" id="advances-active">0</p>
                    </div>
                    <div class="card bg-gradient-to-br from-red-400 to-red-600 text-white">
                        <p class="text-sm opacity-90">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</p>
                        <p class="text-4xl font-bold" id="advances-total">Â£0</p>
                    </div>
                    <div class="card bg-gradient-to-br from-yellow-400 to-yellow-600 text-white">
                        <p class="text-sm opacity-90">Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</p>
                        <p class="text-4xl font-bold" id="advances-remaining">Â£0</p>
                    </div>
                </div>

                <!-- Advances List -->
                <div class="card">
                    <h3 class="text-xl font-bold mb-4 pb-3 border-b-2">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³Ù„Ù</h3>
                    <div id="advances-list" class="space-y-4"></div>
                </div>
            </div>

            <!-- Reports Page -->
            <div id="reports-page" class="page hidden">
                <div class="page-header">
                    <h2 class="text-4xl font-bold mb-2">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</h2>
                    <p class="text-lg opacity-90">ØªÙ‚Ø§Ø±ÙŠØ± Ù…ÙØµÙ„Ø© Ø¹Ù† Ø§Ù„Ø£Ø¯Ø§Ø¡</p>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Weekly Report -->
                    <div class="card bg-gradient-to-br from-blue-50 to-purple-50">
                        <h3 class="text-2xl font-bold mb-4 pb-3 border-b-2">ØªÙ‚Ø±ÙŠØ± Ø£Ø³Ø¨ÙˆØ¹ÙŠ</h3>
                        <div class="space-y-4">
                            <div class="flex justify-between items-center p-4 bg-white rounded-lg shadow">
                                <span class="font-bold text-gray-700">Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª:</span>
                                <span class="text-2xl font-bold text-green-600" id="report-revenue">Â£0</span>
                            </div>
                            <div class="flex justify-between items-center p-4 bg-white rounded-lg shadow">
                                <span class="font-bold text-gray-700">Ø§Ù„Ø±ÙˆØ§ØªØ¨:</span>
                                <span class="text-2xl font-bold text-red-600" id="report-salaries">Â£0</span>
                            </div>
                            <div class="flex justify-between items-center p-4 bg-gradient-to-r from-green-400 to-green-600 text-white rounded-lg shadow-lg">
                                <span class="font-bold">ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­:</span>
                                <span class="text-3xl font-bold" id="report-profit">Â£0</span>
                            </div>
                        </div>
                        <button onclick="downloadReport('weekly')" class="btn btn-primary w-full mt-6">
                            ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ±
                        </button>
                    </div>

                    <!-- Driver Performance -->
                    <div class="card bg-gradient-to-br from-green-50 to-blue-50">
                        <h3 class="text-2xl font-bold mb-4 pb-3 border-b-2">Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†</h3>
                        <div id="driver-performance" class="space-y-3"></div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Driver Modal -->
    <div id="driver-modal" class="modal">
        <div class="modal-content w-full max-w-2xl p-8">
            <div class="flex justify-between items-center mb-6 pb-4 border-b-2">
                <h2 class="text-3xl font-bold text-gray-800">
                    <span id="driver-modal-title">â• Ø¥Ø¶Ø§ÙØ© Ø³Ø§Ø¦Ù‚ Ø¬Ø¯ÙŠØ¯</span>
                </h2>
                <button onclick="closeDriverModal()" class="text-3xl text-gray-500 hover:text-red-600 transition">Ã—</button>
            </div>
            <form id="driver-form" onsubmit="saveDriver(event)">
                <input type="hidden" id="driver-id">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-700">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ *</label>
                        <input type="text" id="driver-name" class="input" required placeholder="Ø£Ø­Ù…Ø¯ Ø¹Ù„ÙŠ Ù…Ø­Ù…Ø¯">
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-700">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ *</label>
                        <input type="tel" id="driver-phone" class="input" required placeholder="+447700900123">
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-700">ÙˆØ§ØªØ³Ø§Ø¨</label>
                        <input type="tel" id="driver-whatsapp" class="input" placeholder="+447700900123">
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-700">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡ *</label>
                        <input type="date" id="driver-start-date" class="input" required>
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-700">Ø§Ù„Ø­Ø§Ù„Ø© *</label>
                        <select id="driver-status" class="input" required>
                            <option value="training">ğŸ“ ØªØ­Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨</option>
                            <option value="active">âœ… Ù†Ø´Ø·</option>
                            <option value="suspended">â›” Ù…ÙˆÙ‚ÙˆÙ</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-700">Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ (Â£) *</label>
                        <input type="number" id="driver-salary" class="input" required value="120" min="0" step="0.01">
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-700">Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©/Ø£Ø³Ø¨ÙˆØ¹ *</label>
                        <input type="number" id="driver-orders" class="input" required value="100" min="0">
                    </div>
                </div>
                <div class="mt-4">
                    <label class="block text-sm font-bold mb-2 text-gray-700">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
                    <textarea id="driver-notes" class="input" rows="3" placeholder="Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©..."></textarea>
                </div>
                <div class="flex gap-3 mt-6">
                    <button type="submit" class="btn btn-success flex-1">ğŸ’¾ Ø­ÙØ¸</button>
                    <button type="button" onclick="closeDriverModal()" class="btn btn-secondary flex-1">âŒ Ø¥Ù„ØºØ§Ø¡</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Company Modal -->
    <div id="company-modal" class="modal">
        <div class="modal-content w-full max-w-2xl p-8">
            <div class="flex justify-between items-center mb-6 pb-4 border-b-2">
                <h2 class="text-3xl font-bold text-gray-800">
                    <span id="company-modal-title">ğŸ¢ Ø¥Ø¶Ø§ÙØ© Ø´Ø±ÙƒØ© Ø¬Ø¯ÙŠØ¯Ø©</span>
                </h2>
                <button onclick="closeCompanyModal()" class="text-3xl text-gray-500 hover:text-red-600 transition">Ã—</button>
            </div>
            <form id="company-form" onsubmit="saveCompany(event)">
                <input type="hidden" id="company-id">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-700">Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ© *</label>
                        <input type="text" id="company-name" class="input" required placeholder="Company A Ltd">
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-700">Ø¬Ù‡Ø© Ø§Ù„Ø§ØªØµØ§Ù„ *</label>
                        <input type="text" id="company-contact" class="input" required placeholder="Jane Doe">
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-700">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ *</label>
                        <input type="tel" id="company-phone" class="input" required placeholder="+447700900888">
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-700">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ *</label>
                        <input type="email" id="company-email" class="input" required placeholder="contact@company.com">
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-700">Ø§Ù„Ø­Ø§Ù„Ø© *</label>
                        <select id="company-status" class="input" required>
                            <option value="active">âœ… Ù†Ø´Ø·Ø©</option>
                            <option value="inactive">â¸ï¸ Ù…ØªÙˆÙ‚ÙØ©</option>
                        </select>
                    </div>
                </div>
                <div class="mt-4">
                    <label class="block text-sm font-bold mb-2 text-gray-700">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
                    <textarea id="company-notes" class="input" rows="3" placeholder="ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø®Ø§ØµØ©ØŒ Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„ØªÙˆØµÙŠÙ„ØŒ Ø¥Ù„Ø®..."></textarea>
                </div>
                <div class="flex gap-3 mt-6">
                    <button type="submit" class="btn btn-success flex-1">ğŸ’¾ Ø­ÙØ¸</button>
                    <button type="button" onclick="closeCompanyModal()" class="btn btn-secondary flex-1">âŒ Ø¥Ù„ØºØ§Ø¡</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Order Modal -->
    <div id="order-modal" class="modal">
        <div class="modal-content w-full max-w-2xl p-8">
            <div class="flex justify-between items-center mb-6 pb-4 border-b-2">
                <h2 class="text-3xl font-bold text-gray-800">
                    <span id="order-modal-title">ğŸ“¦ Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</span>
                </h2>
                <button onclick="closeOrderModal()" class="text-3xl text-gray-500 hover:text-red-600 transition">Ã—</button>
            </div>
            <form id="order-form" onsubmit="saveOrder(event)">
                <input type="hidden" id="order-id">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-700">Ø§Ù„Ø´Ø±ÙƒØ© *</label>
                        <select id="order-company" class="input" required>
                            <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ø´Ø±ÙƒØ© --</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-700">Ø§Ù„Ø³Ø§Ø¦Ù‚ *</label>
                        <select id="order-driver" class="input" required>
                            <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ø³Ø§Ø¦Ù‚ --</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-700">Ø§Ù„ØªØ§Ø±ÙŠØ® *</label>
                        <input type="date" id="order-date" class="input" required>
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-700">Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø¨Ø±ÙŠØ¯ÙŠ</label>
                        <input type="text" id="order-postcode" class="input" placeholder="SW1A 1AA">
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-700">Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
                        <input type="text" id="order-customer" class="input" placeholder="John Smith">
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-700">Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
                        <input type="tel" id="order-customer-phone" class="input" placeholder="+447700900001">
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-700">Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª (Â£) *</label>
                        <input type="number" id="order-revenue" class="input" required min="0" step="0.01" placeholder="15.00">
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-700">Ø§Ù„Ø­Ø§Ù„Ø© *</label>
                        <select id="order-status" class="input" required>
                            <option value="pending">â³ Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</option>
                            <option value="in_progress">ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙ†ÙÙŠØ°</option>
                            <option value="completed">âœ… Ù…ÙƒØªÙ…Ù„</option>
                        </select>
                    </div>
                </div>
                <div class="mt-4">
                    <label class="block text-sm font-bold mb-2 text-gray-700">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
                    <textarea id="order-notes" class="input" rows="2" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©..."></textarea>
                </div>
                <div class="flex gap-3 mt-6">
                    <button type="submit" class="btn btn-success flex-1">ğŸ’¾ Ø­ÙØ¸</button>
                    <button type="button" onclick="closeOrderModal()" class="btn btn-secondary flex-1">âŒ Ø¥Ù„ØºØ§Ø¡</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Advance Modal -->
    <div id="advance-modal" class="modal">
        <div class="modal-content w-full max-w-2xl p-8">
            <div class="flex justify-between items-center mb-6 pb-4 border-b-2">
                <h2 class="text-3xl font-bold text-gray-800">
                    <span id="advance-modal-title">ğŸ’³ Ø¥Ø¶Ø§ÙØ© Ø³Ù„ÙØ© Ø¬Ø¯ÙŠØ¯Ø©</span>
                </h2>
                <button onclick="closeAdvanceModal()" class="text-3xl text-gray-500 hover:text-red-600 transition">Ã—</button>
            </div>
            <form id="advance-form" onsubmit="saveAdvance(event)">
                <input type="hidden" id="advance-id">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-700">Ø§Ù„Ø³Ø§Ø¦Ù‚ *</label>
                        <select id="advance-driver" class="input" required>
                            <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ø³Ø§Ø¦Ù‚ --</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-700">Ø§Ù„Ù…Ø¨Ù„Øº (Â£) *</label>
                        <input type="number" id="advance-amount" class="input" required min="0" step="0.01" placeholder="100.00">
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-700">Ø§Ù„ØªØ§Ø±ÙŠØ® *</label>
                        <input type="date" id="advance-date" class="input" required>
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-700">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹ *</label>
                        <select id="advance-payment-method" class="input" required onchange="toggleInstallments()">
                            <option value="one_time">ğŸ’µ Ø¯ÙØ¹Ø© ÙˆØ§Ø­Ø¯Ø©</option>
                            <option value="installments">ğŸ“Š Ø£Ù‚Ø³Ø§Ø·</option>
                        </select>
                    </div>
                    <div id="installment-section" class="hidden">
                        <label class="block text-sm font-bold mb-2 text-gray-700">Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù‚Ø³Ø§Ø·</label>
                        <input type="number" id="advance-installments" class="input" min="2" value="4" onchange="calculateInstallmentAmount()">
                    </div>
                    <div id="installment-amount-section" class="hidden">
                        <label class="block text-sm font-bold mb-2 text-gray-700">Ù‚ÙŠÙ…Ø© Ø§Ù„Ù‚Ø³Ø· (Â£)</label>
                        <input type="number" id="advance-installment-amount" class="input" readonly>
                    </div>
                </div>
                <div class="mt-4">
                    <label class="block text-sm font-bold mb-2 text-gray-700">Ø³Ø¨Ø¨ Ø§Ù„Ø³Ù„ÙØ©</label>
                    <textarea id="advance-reason" class="input" rows="2" placeholder="Ø³Ø¨Ø¨ Ø§Ù„Ø³Ù„ÙØ©..."></textarea>
                </div>
                <div class="flex gap-3 mt-6">
                    <button type="submit" class="btn btn-success flex-1">ğŸ’¾ Ø­ÙØ¸</button>
                    <button type="button" onclick="closeAdvanceModal()" class="btn btn-secondary flex-1">âŒ Ø¥Ù„ØºØ§Ø¡</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Data Storage
        let drivers = JSON.parse(localStorage.getItem('drivers_pro') || '[]');
        let companies = JSON.parse(localStorage.getItem('companies_pro') || '[]');
        let orders = JSON.parse(localStorage.getItem('orders_pro') || '[]');
        let salaries = JSON.parse(localStorage.getItem('salaries_pro') || '[]');
        let advances = JSON.parse(localStorage.getItem('advances_pro') || '[]');

        // Initialize with sample data if empty
        if (drivers.length === 0) {
            drivers = [
                {id: 1001, name: 'Ø£Ø­Ù…Ø¯ Ø¹Ù„ÙŠ Ù…Ø­Ù…Ø¯', phone: '+447700900123', whatsapp: '+447700900123', startDate: '2024-01-15', status: 'active', salary: 120, requiredOrders: 100, notes: 'Ø³Ø§Ø¦Ù‚ Ù…Ù…ØªØ§Ø²'},
                {id: 1002, name: 'Ù…Ø­Ù…Ø¯ Ø­Ø³Ù† Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…', phone: '+447700900124', whatsapp: '+447700900124', startDate: '2024-12-10', status: 'training', salary: 120, requiredOrders: 100, notes: ''},
                {id: 1003, name: 'Ø®Ø§Ù„Ø¯ Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø£Ø­Ù…Ø¯', phone: '+447700900125', whatsapp: '+447700900125', startDate: '2024-02-01', status: 'active', salary: 120, requiredOrders: 100, notes: 'Ù…ÙˆØ«ÙˆÙ‚'}
            ];
            localStorage.setItem('drivers_pro', JSON.stringify(drivers));
        }

        if (companies.length === 0) {
            companies = [
                {id: 2001, name: 'Company A Ltd', contact: 'Jane Doe', phone: '+447700900888', email: 'jane@companya.com', status: 'active', notes: 'Always ring bell twice'},
                {id: 2002, name: 'Express Delivery Co', contact: 'John Smith', phone: '+447700900777', email: 'john@express.com', status: 'active', notes: 'Call before delivery'}
            ];
            localStorage.setItem('companies_pro', JSON.stringify(companies));
        }
        
        if (orders.length === 0) {
            orders = [
                {id: 3001, companyId: 2001, driverId: 1001, date: '2024-12-20', postcode: 'SW1A 1AA', customer: 'John Smith', phone: '+447700900001', revenue: 15, notes: '', status: 'completed'},
                {id: 3002, companyId: 2002, driverId: 1001, date: '2024-12-20', postcode: 'SW1A 2AA', customer: 'Mary Johnson', phone: '+447700900002', revenue: 25, notes: '', status: 'completed'},
                {id: 3003, companyId: 2001, driverId: 1003, date: '2024-12-21', postcode: 'W1A 1AA', customer: 'David Brown', phone: '+447700900003', revenue: 15, notes: '', status: 'in_progress'}
            ];
            localStorage.setItem('orders_pro', JSON.stringify(orders));
        }

        // Helper Functions
        function formatCurrency(amount) {
            return 'Â£' + parseFloat(amount).toFixed(2);
        }

        function formatDate(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleDateString('ar-SA');
        }

        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
        }

        function showPage(pageName) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => page.classList.add('hidden'));
            document.getElementById(pageName + '-page').classList.remove('hidden');
            
            // Update active nav
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[data-page="${pageName}"]`).classList.add('active');
            
            // Load page data
            if (pageName === 'dashboard') loadDashboard();
            else if (pageName === 'drivers') loadDrivers();
            else if (pageName === 'companies') loadCompanies();
            else if (pageName === 'orders') loadOrders();
            else if (pageName === 'salaries') loadSalaries();
            else if (pageName === 'advances') loadAdvances();
            else if (pageName === 'reports') loadReports();

            // Close sidebar on mobile
            if (window.innerWidth < 768) {
                document.getElementById('sidebar').classList.remove('open');
            }
        }

        // Dashboard Functions
        function loadDashboard() {
            const totalRevenue = orders.reduce((sum, o) => sum + parseFloat(o.revenue), 0);
            const totalSalaries = salaries.reduce((sum, s) => sum + parseFloat(s.finalSalary || 0), 0);
            const netProfit = totalRevenue - totalSalaries;
            
            document.getElementById('total-revenue').textContent = formatCurrency(totalRevenue);
            document.getElementById('total-salaries').textContent = formatCurrency(totalSalaries);
            document.getElementById('net-profit').textContent = formatCurrency(netProfit);
            document.getElementById('total-orders').textContent = orders.length;
            
            document.getElementById('active-drivers').textContent = drivers.filter(d => d.status === 'active').length;
            document.getElementById('training-drivers').textContent = drivers.filter(d => d.status === 'training').length;
            document.getElementById('active-companies').textContent = companies.filter(c => c.status === 'active').length;
            document.getElementById('completed-orders').textContent = orders.filter(o => o.status === 'completed').length;

            // Quick stats
            const avgRevenue = orders.length > 0 ? totalRevenue / orders.length : 0;
            const avgOrders = drivers.length > 0 ? orders.length / drivers.filter(d => d.status === 'active').length : 0;
            const profitMargin = totalRevenue > 0 ? ((netProfit / totalRevenue) * 100) : 0;
            
            document.getElementById('avg-revenue').textContent = formatCurrency(avgRevenue);
            document.getElementById('avg-orders').textContent = avgOrders.toFixed(1);
            document.getElementById('profit-margin').textContent = profitMargin.toFixed(1) + '%';

            loadRecentActivity();
        }

        function loadRecentActivity() {
            const container = document.getElementById('recent-activity');
            const recent = orders.slice(-5).reverse();
            
            if (recent.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-500 py-8">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†Ø´Ø§Ø·Ø§Øª Ø­Ø¯ÙŠØ«Ø©</p>';
                return;
            }
            
            container.innerHTML = recent.map(order => {
                const driver = drivers.find(d => d.id == order.driverId);
                const company = companies.find(c => c.id == order.companyId);
                return `
                    <div class="flex items-start gap-3 p-3 bg-gradient-to-r from-green-50 to-blue-50 rounded-lg border-l-4 border-green-500 hover:shadow-md transition">
                        <span class="text-green-500 text-2xl">âœ“</span>
                        <div class="flex-1">
                            <p class="text-sm font-semibold text-gray-800">Ø·Ù„Ø¨ Ù…Ù† ${company?.name || 'Ø´Ø±ÙƒØ©'} ØªÙ… ØªØ¹ÙŠÙŠÙ†Ù‡ Ù„Ù€ ${driver?.name || 'Ø³Ø§Ø¦Ù‚'}</p>
                            <p class="text-xs text-gray-500 mt-1">ğŸ“… ${formatDate(order.date)} | ğŸ’° ${formatCurrency(order.revenue)}</p>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Driver Functions
        function loadDrivers() {
            document.getElementById('drivers-active').textContent = drivers.filter(d => d.status === 'active').length;
            document.getElementById('drivers-training').textContent = drivers.filter(d => d.status === 'training').length;
            document.getElementById('drivers-suspended').textContent = drivers.filter(d => d.status === 'suspended').length;
            renderDrivers();
        }

        function renderDrivers(filteredDrivers = drivers) {
            const container = document.getElementById('drivers-list');
            
            if (filteredDrivers.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-500 py-8">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø³Ø§Ø¦Ù‚ÙŠÙ†</p>';
                return;
            }
            
            container.innerHTML = filteredDrivers.map(driver => `
                <div class="p-5 border-2 border-gray-100 rounded-xl hover:shadow-xl transition-all hover:border-blue-300 bg-gradient-to-r from-white to-gray-50">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <h3 class="font-bold text-xl text-gray-800 mb-2">${driver.name}</h3>
                            <div class="grid grid-cols-2 gap-3">
                                <p class="text-sm text-gray-600">ğŸ“± ${driver.phone}</p>
                                <p class="text-sm text-gray-600">ğŸ“… ${formatDate(driver.startDate)}</p>
                                <p class="text-sm text-gray-600">ğŸ’° ${formatCurrency(driver.salary)}</p>
                                <p class="text-sm text-gray-600">ğŸ“¦ ${driver.requiredOrders} Ø·Ù„Ø¨/Ø£Ø³Ø¨ÙˆØ¹</p>
                            </div>
                        </div>
                        <div class="text-left space-y-3">
                            <span class="badge ${driver.status === 'active' ? 'badge-success' : driver.status === 'training' ? 'badge-warning' : 'badge-danger'} text-sm">
                                ${driver.status === 'active' ? 'âœ… Ù†Ø´Ø·' : driver.status === 'training' ? 'ğŸ“ ØªØ¯Ø±ÙŠØ¨' : 'â›” Ù…ÙˆÙ‚ÙˆÙ'}
                            </span>
                            <div class="flex gap-2">
                                <button onclick="editDriver(${driver.id})" class="p-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition">âœï¸</button>
                                <button onclick="deleteDriver(${driver.id})" class="p-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition">ğŸ—‘ï¸</button>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function filterDrivers() {
            const search = document.getElementById('driver-search').value.toLowerCase();
            const filtered = drivers.filter(d => 
                d.name.toLowerCase().includes(search) || 
                d.phone.includes(search)
            );
            renderDrivers(filtered);
        }

        function editDriver(id) {
            alert('ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø³Ø§Ø¦Ù‚ - Ù‚Ø±ÙŠØ¨Ø§Ù‹');
        }

        function deleteDriver(id) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø³Ø§Ø¦Ù‚ØŸ')) {
                drivers = drivers.filter(d => d.id !== id);
                localStorage.setItem('drivers_pro', JSON.stringify(drivers));
                loadDrivers();
            }
        }

        // Company Functions
        function loadCompanies() {
            const container = document.getElementById('companies-list');
            
            container.innerHTML = companies.map(company => `
                <div class="card bg-gradient-to-br from-white to-blue-50 border-2 border-blue-100 hover:shadow-2xl transition-all">
                    <div class="flex items-start justify-between mb-4">
                        <div>
                            <h3 class="font-bold text-xl text-gray-800">${company.name}</h3>
                            <p class="text-sm text-gray-600 mt-1">ğŸ‘¤ ${company.contact}</p>
                        </div>
                        <span class="badge ${company.status === 'active' ? 'badge-success' : 'badge-warning'} text-sm">
                            ${company.status === 'active' ? 'âœ… Ù†Ø´Ø·Ø©' : 'â¸ï¸ Ù…ØªÙˆÙ‚ÙØ©'}
                        </span>
                    </div>
                    <div class="space-y-2 mb-4 bg-white p-3 rounded-lg">
                        <p class="text-sm">ğŸ“§ ${company.email}</p>
                        <p class="text-sm">ğŸ“± ${company.phone}</p>
                        <p class="text-xs text-gray-500 mt-2">${company.notes || 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª'}</p>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="editCompany(${company.id})" class="btn btn-primary flex-1 text-sm">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
                        <button onclick="deleteCompany(${company.id})" class="btn btn-danger flex-1 text-sm">ğŸ—‘ï¸ Ø­Ø°Ù</button>
                    </div>
                </div>
            `).join('');
        }

        function deleteCompany(id) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø´Ø±ÙƒØ©ØŸ')) {
                companies = companies.filter(c => c.id !== id);
                localStorage.setItem('companies_pro', JSON.stringify(companies));
                loadCompanies();
            }
        }

        // Order Functions with MANUAL PRICING
        function loadOrders() {
            document.getElementById('orders-total').textContent = orders.length;
            document.getElementById('orders-completed').textContent = orders.filter(o => o.status === 'completed').length;
            document.getElementById('orders-progress').textContent = orders.filter(o => o.status === 'in_progress').length;
            document.getElementById('orders-revenue').textContent = formatCurrency(orders.reduce((sum, o) => sum + parseFloat(o.revenue), 0));
            
            renderOrders();
        }

        function renderOrders() {
            const container = document.getElementById('orders-list');
            
            if (orders.length === 0) {
                container.innerHTML = '<tr><td colspan="8" class="text-center py-8 text-gray-500">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª</td></tr>';
                return;
            }
            
            container.innerHTML = orders.map((order, index) => {
                const company = companies.find(c => c.id == order.companyId);
                const driver = drivers.find(d => d.id == order.driverId);
                const bgColor = index % 2 === 0 ? 'bg-white' : 'bg-gray-50';
                return `
                    <tr class="table-row ${bgColor} border-b border-gray-200">
                        <td class="p-4 font-bold text-blue-600">#${order.id}</td>
                        <td class="p-4">${formatDate(order.date)}</td>
                        <td class="p-4 font-semibold">${company?.name || '-'}</td>
                        <td class="p-4 font-semibold">${driver?.name || '-'}</td>
                        <td class="p-4">
                            <div>${order.customer || '-'}</div>
                            <small class="text-gray-500">${order.postcode || ''}</small>
                        </td>
                        <td class="p-4 font-bold text-green-600 text-lg">${formatCurrency(order.revenue)}</td>
                        <td class="p-4">
                            <span class="badge ${order.status === 'completed' ? 'badge-success' : order.status === 'in_progress' ? 'badge-info' : 'badge-warning'}">
                                ${order.status === 'completed' ? 'âœ… Ù…ÙƒØªÙ…Ù„' : order.status === 'in_progress' ? 'ğŸ”„ Ø¬Ø§Ø±ÙŠ' : 'â³ Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±'}
                            </span>
                        </td>
                        <td class="p-4">
                            <button onclick="editOrder(${order.id})" class="p-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition mr-2">âœï¸</button>
                            <button onclick="updateOrderStatus(${order.id})" class="p-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition mr-2">âœ“</button>
                            <button onclick="deleteOrder(${order.id})" class="p-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition">ğŸ—‘ï¸</button>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function updateOrderStatus(id) {
            const order = orders.find(o => o.id === id);
            if (order.status === 'pending') order.status = 'in_progress';
            else if (order.status === 'in_progress') order.status = 'completed';
            
            localStorage.setItem('orders_pro', JSON.stringify(orders));
            loadOrders();
        }

        function deleteOrder(id) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø·Ù„Ø¨ØŸ')) {
                orders = orders.filter(o => o.id !== id);
                localStorage.setItem('orders_pro', JSON.stringify(orders));
                loadOrders();
            }
        }

        // Salary Functions
        function loadSalaries() {
            const totalSalaries = salaries.reduce((sum, s) => sum + parseFloat(s.finalSalary || 0), 0);
            const totalBonus = salaries.reduce((sum, s) => sum + parseFloat(s.bonus || 0), 0);
            const totalDeductions = salaries.reduce((sum, s) => sum + parseFloat(s.deductions || 0), 0);
            
            document.getElementById('salaries-total').textContent = formatCurrency(totalSalaries);
            document.getElementById('salaries-bonus').textContent = formatCurrency(totalBonus);
            document.getElementById('salaries-deductions').textContent = formatCurrency(totalDeductions);
            
            renderSalaries();
        }

        function renderSalaries() {
            const container = document.getElementById('salaries-list');
            
            if (salaries.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-500 py-8">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±ÙˆØ§ØªØ¨ Ù…Ø­Ø³ÙˆØ¨Ø©. Ø§Ø¶ØºØ· "Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±ÙˆØ§ØªØ¨ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©" Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨.</p>';
                return;
            }
            
            container.innerHTML = salaries.map(salary => {
                const driver = drivers.find(d => d.id == salary.driverId);
                return `
                    <div class="p-5 border-2 border-gray-100 rounded-xl bg-gradient-to-r from-white to-green-50 hover:shadow-lg transition">
                        <div class="flex items-center justify-between mb-4">
                            <div>
                                <h3 class="font-bold text-xl">${driver?.name || 'Ø³Ø§Ø¦Ù‚'}</h3>
                                <p class="text-sm text-gray-600">Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ ${salary.week}</p>
                            </div>
                            <span class="badge badge-success text-sm">${salary.status === 'paid' ? 'âœ… Ù…Ø¯ÙÙˆØ¹' : 'â³ Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±'}</span>
                        </div>
                        <div class="grid grid-cols-4 gap-4 text-center bg-white p-4 rounded-lg">
                            <div>
                                <p class="text-xs text-gray-600 mb-1">Ø§Ù„Ø·Ù„Ø¨Ø§Øª</p>
                                <p class="font-bold text-lg">${salary.totalOrders}</p>
                            </div>
                            <div>
                                <p class="text-xs text-gray-600 mb-1">Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ</p>
                                <p class="font-bold text-lg">${formatCurrency(salary.baseSalary)}</p>
                            </div>
                            <div>
                                <p class="text-xs text-gray-600 mb-1">Ø§Ù„Ø¨ÙˆÙ†Øµ</p>
                                <p class="font-bold text-lg text-green-600">${formatCurrency(salary.bonus)}</p>
                            </div>
                            <div>
                                <p class="text-xs text-gray-600 mb-1">Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</p>
                                <p class="font-bold text-xl text-blue-600">${formatCurrency(salary.finalSalary)}</p>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function calculateWeeklySalaries() {
            if (!confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø³Ø§Ø¨ Ø±ÙˆØ§ØªØ¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ† Ù„Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø­Ø§Ù„ÙŠØŸ')) return;
            
            const currentWeek = 51;
            salaries = [];
            
            drivers.forEach(driver => {
                const driverOrders = orders.filter(o => o.driverId == driver.id).length;
                
                const startDate = new Date(driver.startDate);
                const now = new Date();
                const diffDays = Math.floor((now - startDate) / (1000 * 60 * 60 * 24));
                const isTraining = diffDays <= 14;
                
                let baseSalary = 0;
                let bonus = 0;
                let finalSalary = 0;
                
                if (isTraining) {
                    baseSalary = 0;
                    bonus = 0;
                    finalSalary = 0;
                } else if (driverOrders < driver.requiredOrders) {
                    baseSalary = 0;
                    bonus = 0;
                    finalSalary = 0;
                } else if (driverOrders >= driver.requiredOrders) {
                    baseSalary = driver.salary;
                    if (driverOrders > driver.requiredOrders) {
                        bonus = driverOrders - driver.requiredOrders;
                    }
                    finalSalary = baseSalary + bonus;
                }
                
                const driverAdvances = advances.filter(a => a.driverId == driver.id && a.status === 'active');
                let deductions = 0;
                driverAdvances.forEach(advance => {
                    if (advance.paymentMethod === 'installments') {
                        deductions += parseFloat(advance.installmentAmount || 0);
                    } else {
                        deductions += parseFloat(advance.remaining || 0);
                    }
                });
                
                finalSalary = Math.max(0, finalSalary - deductions);
                
                salaries.push({
                    id: Date.now() + driver.id,
                    driverId: driver.id,
                    week: currentWeek,
                    totalOrders: driverOrders,
                    requiredOrders: driver.requiredOrders,
                    baseSalary: baseSalary,
                    bonus: bonus,
                    deductions: deductions,
                    finalSalary: finalSalary,
                    isTraining: isTraining,
                    status: 'pending'
                });
            });
            
            localStorage.setItem('salaries_pro', JSON.stringify(salaries));
            loadSalaries();
            alert('âœ… ØªÙ… Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±ÙˆØ§ØªØ¨ Ø¨Ù†Ø¬Ø§Ø­!');
        }

        // Advance Functions
        function loadAdvances() {
            const activeAdvances = advances.filter(a => a.status === 'active');
            const totalAmount = advances.reduce((sum, a) => sum + parseFloat(a.amount || 0), 0);
            const totalRemaining = activeAdvances.reduce((sum, a) => sum + parseFloat(a.remaining || 0), 0);
            
            document.getElementById('advances-active').textContent = activeAdvances.length;
            document.getElementById('advances-total').textContent = formatCurrency(totalAmount);
            document.getElementById('advances-remaining').textContent = formatCurrency(totalRemaining);
            
            renderAdvances();
        }

        function renderAdvances() {
            const container = document.getElementById('advances-list');
            
            if (advances.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-500 py-8">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ù„Ù</p>';
                return;
            }
            
            container.innerHTML = advances.map(advance => {
                const driver = drivers.find(d => d.id == advance.driverId);
                const progress = ((parseFloat(advance.amount) - parseFloat(advance.remaining)) / parseFloat(advance.amount)) * 100;
                
                return `
                    <div class="p-5 border-2 border-gray-100 rounded-xl bg-gradient-to-r from-white to-orange-50 hover:shadow-lg transition">
                        <div class="flex items-center justify-between mb-4">
                            <div>
                                <h3 class="font-bold text-xl">${driver?.name || 'Ø³Ø§Ø¦Ù‚'}</h3>
                                <p class="text-sm text-gray-600">ğŸ“… ${formatDate(advance.date)}</p>
                            </div>
                            <span class="badge ${advance.status === 'active' ? 'badge-warning' : 'badge-success'} text-sm">
                                ${advance.status === 'active' ? 'â³ Ù†Ø´Ø·' : 'âœ… Ù…Ø¯ÙÙˆØ¹'}
                            </span>
                        </div>
                        <div class="grid grid-cols-3 gap-4 mb-4 bg-white p-4 rounded-lg">
                            <div>
                                <p class="text-xs text-gray-600 mb-1">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„ÙƒÙ„ÙŠ</p>
                                <p class="font-bold text-lg">${formatCurrency(advance.amount)}</p>
                            </div>
                            <div>
                                <p class="text-xs text-gray-600 mb-1">Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</p>
                                <p class="font-bold text-lg text-red-600">${formatCurrency(advance.remaining)}</p>
                            </div>
                            <div>
                                <p class="text-xs text-gray-600 mb-1">Ø§Ù„Ø·Ø±ÙŠÙ‚Ø©</p>
                                <p class="text-sm font-semibold">${advance.paymentMethod === 'installments' ? 'ğŸ“Š Ø£Ù‚Ø³Ø§Ø·' : 'ğŸ’µ Ø¯ÙØ¹Ø© ÙˆØ§Ø­Ø¯Ø©'}</p>
                            </div>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-3 overflow-hidden">
                            <div class="bg-gradient-to-r from-green-400 to-green-600 h-3 rounded-full transition-all duration-500" style="width: ${progress}%"></div>
                        </div>
                        <p class="text-xs text-gray-600 mt-2 text-center font-semibold">${progress.toFixed(0)}% Ù…Ø¯ÙÙˆØ¹</p>
                    </div>
                `;
            }).join('');
        }

        // Reports Functions
        function loadReports() {
            const totalRevenue = orders.reduce((sum, o) => sum + parseFloat(o.revenue), 0);
            const totalSalaries = salaries.reduce((sum, s) => sum + parseFloat(s.finalSalary || 0), 0);
            const netProfit = totalRevenue - totalSalaries;
            
            document.getElementById('report-revenue').textContent = formatCurrency(totalRevenue);
            document.getElementById('report-salaries').textContent = formatCurrency(totalSalaries);
            document.getElementById('report-profit').textContent = formatCurrency(netProfit);
            
            const container = document.getElementById('driver-performance');
            const driverStats = drivers.map(driver => {
                const driverOrders = orders.filter(o => o.driverId == driver.id).length;
                return { driver, orders: driverOrders };
            }).sort((a, b) => b.orders - a.orders);
            
            container.innerHTML = driverStats.map((stat, index) => `
                <div class="flex items-center justify-between p-4 ${index < 3 ? 'bg-gradient-to-r from-yellow-100 to-yellow-200' : 'bg-white'} rounded-lg shadow border-2 ${index < 3 ? 'border-yellow-400' : 'border-gray-200'} hover:shadow-lg transition">
                    <div class="flex items-center gap-3">
                        <span class="text-2xl font-bold ${index < 3 ? 'text-yellow-600' : 'text-gray-600'}">${index + 1}</span>
                        <span class="font-semibold text-gray-800">${stat.driver.name}</span>
                    </div>
                    <span class="font-bold text-xl ${index < 3 ? 'text-yellow-700' : 'text-gray-700'}">${stat.orders} Ø·Ù„Ø¨</span>
                </div>
            `).join('');
        }

        function downloadReport(type) {
            const totalRevenue = orders.reduce((sum, o) => sum + parseFloat(o.revenue), 0);
            const totalSalaries = salaries.reduce((sum, s) => sum + parseFloat(s.finalSalary || 0), 0);
            const netProfit = totalRevenue - totalSalaries;
            
            let reportContent = `ØªÙ‚Ø±ÙŠØ± ${type === 'weekly' ? 'Ø£Ø³Ø¨ÙˆØ¹ÙŠ' : 'Ø´Ù‡Ø±ÙŠ'}\n\n`;
            reportContent += `=================================\n`;
            reportContent += `Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª: ${formatCurrency(totalRevenue)}\n`;
            reportContent += `Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§ØªØ¨: ${formatCurrency(totalSalaries)}\n`;
            reportContent += `ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­: ${formatCurrency(netProfit)}\n`;
            reportContent += `=================================\n\n`;
            
            reportContent += `ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†:\n`;
            drivers.forEach(driver => {
                const driverOrders = orders.filter(o => o.driverId == driver.id).length;
                const driverRevenue = orders.filter(o => o.driverId == driver.id).reduce((sum, o) => sum + parseFloat(o.revenue), 0);
                reportContent += `- ${driver.name}: ${driverOrders} Ø·Ù„Ø¨ØŒ Ø¥ÙŠØ±Ø§Ø¯Ø§Øª: ${formatCurrency(driverRevenue)}\n`;
            });
            
            const blob = new Blob([reportContent], { type: 'text/plain;charset=utf-8' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `report_${type}_${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        // Driver Modal Functions
        function openDriverModal(driverId = null) {
            const modal = document.getElementById('driver-modal');
            const form = document.getElementById('driver-form');
            form.reset();
            
            if (driverId) {
                const driver = drivers.find(d => d.id === driverId);
                if (driver) {
                    document.getElementById('driver-modal-title').textContent = 'âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø§Ø¦Ù‚';
                    document.getElementById('driver-id').value = driver.id;
                    document.getElementById('driver-name').value = driver.name;
                    document.getElementById('driver-phone').value = driver.phone;
                    document.getElementById('driver-whatsapp').value = driver.whatsapp || driver.phone;
                    document.getElementById('driver-start-date').value = driver.startDate;
                    document.getElementById('driver-status').value = driver.status;
                    document.getElementById('driver-salary').value = driver.salary;
                    document.getElementById('driver-orders').value = driver.requiredOrders;
                    document.getElementById('driver-notes').value = driver.notes || '';
                }
            } else {
                document.getElementById('driver-modal-title').textContent = 'â• Ø¥Ø¶Ø§ÙØ© Ø³Ø§Ø¦Ù‚ Ø¬Ø¯ÙŠØ¯';
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('driver-start-date').value = today;
            }
            
            modal.classList.add('active');
        }

        function closeDriverModal() {
            document.getElementById('driver-modal').classList.remove('active');
        }

        function saveDriver(event) {
            event.preventDefault();
            
            const id = document.getElementById('driver-id').value;
            const driverData = {
                id: id ? parseInt(id) : Date.now(),
                name: document.getElementById('driver-name').value,
                phone: document.getElementById('driver-phone').value,
                whatsapp: document.getElementById('driver-whatsapp').value || document.getElementById('driver-phone').value,
                startDate: document.getElementById('driver-start-date').value,
                status: document.getElementById('driver-status').value,
                salary: parseFloat(document.getElementById('driver-salary').value),
                requiredOrders: parseInt(document.getElementById('driver-orders').value),
                notes: document.getElementById('driver-notes').value
            };
            
            if (id) {
                const index = drivers.findIndex(d => d.id === parseInt(id));
                drivers[index] = driverData;
            } else {
                drivers.push(driverData);
            }
            
            localStorage.setItem('drivers_pro', JSON.stringify(drivers));
            closeDriverModal();
            loadDrivers();
            alert('âœ… ØªÙ… Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø§Ø¦Ù‚ Ø¨Ù†Ø¬Ø§Ø­!');
        }

        function editDriver(id) {
            openDriverModal(id);
        }

        // Company Modal Functions
        function openCompanyModal(companyId = null) {
            const modal = document.getElementById('company-modal');
            const form = document.getElementById('company-form');
            form.reset();
            
            if (companyId) {
                const company = companies.find(c => c.id === companyId);
                if (company) {
                    document.getElementById('company-modal-title').textContent = 'âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø±ÙƒØ©';
                    document.getElementById('company-id').value = company.id;
                    document.getElementById('company-name').value = company.name;
                    document.getElementById('company-contact').value = company.contact;
                    document.getElementById('company-phone').value = company.phone;
                    document.getElementById('company-email').value = company.email;
                    document.getElementById('company-status').value = company.status;
                    document.getElementById('company-notes').value = company.notes || '';
                }
            } else {
                document.getElementById('company-modal-title').textContent = 'ğŸ¢ Ø¥Ø¶Ø§ÙØ© Ø´Ø±ÙƒØ© Ø¬Ø¯ÙŠØ¯Ø©';
            }
            
            modal.classList.add('active');
        }

        function closeCompanyModal() {
            document.getElementById('company-modal').classList.remove('active');
        }

        function saveCompany(event) {
            event.preventDefault();
            
            const id = document.getElementById('company-id').value;
            const companyData = {
                id: id ? parseInt(id) : Date.now(),
                name: document.getElementById('company-name').value,
                contact: document.getElementById('company-contact').value,
                phone: document.getElementById('company-phone').value,
                email: document.getElementById('company-email').value,
                status: document.getElementById('company-status').value,
                notes: document.getElementById('company-notes').value
            };
            
            if (id) {
                const index = companies.findIndex(c => c.id === parseInt(id));
                companies[index] = companyData;
            } else {
                companies.push(companyData);
            }
            
            localStorage.setItem('companies_pro', JSON.stringify(companies));
            closeCompanyModal();
            loadCompanies();
            alert('âœ… ØªÙ… Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø±ÙƒØ© Ø¨Ù†Ø¬Ø§Ø­!');
        }

        function editCompany(id) {
            openCompanyModal(id);
        }

        // Order Modal Functions
        function openOrderModal(orderId = null) {
            const modal = document.getElementById('order-modal');
            const form = document.getElementById('order-form');
            form.reset();
            
            // Populate company dropdown
            const companySelect = document.getElementById('order-company');
            companySelect.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ø´Ø±ÙƒØ© --</option>' + 
                companies.filter(c => c.status === 'active').map(c => 
                    `<option value="${c.id}">${c.name}</option>`
                ).join('');
            
            // Populate driver dropdown
            const driverSelect = document.getElementById('order-driver');
            driverSelect.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ø³Ø§Ø¦Ù‚ --</option>' + 
                drivers.filter(d => d.status === 'active' || d.status === 'training').map(d => 
                    `<option value="${d.id}">${d.name}</option>`
                ).join('');
            
            if (orderId) {
                const order = orders.find(o => o.id === orderId);
                if (order) {
                    document.getElementById('order-modal-title').textContent = 'âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨';
                    document.getElementById('order-id').value = order.id;
                    document.getElementById('order-company').value = order.companyId;
                    document.getElementById('order-driver').value = order.driverId;
                    document.getElementById('order-date').value = order.date;
                    document.getElementById('order-postcode').value = order.postcode || '';
                    document.getElementById('order-customer').value = order.customer || '';
                    document.getElementById('order-customer-phone').value = order.phone || '';
                    document.getElementById('order-revenue').value = order.revenue;
                    document.getElementById('order-status').value = order.status;
                    document.getElementById('order-notes').value = order.notes || '';
                }
            } else {
                document.getElementById('order-modal-title').textContent = 'ğŸ“¦ Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯';
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('order-date').value = today;
            }
            
            modal.classList.add('active');
        }

        function closeOrderModal() {
            document.getElementById('order-modal').classList.remove('active');
        }

        function saveOrder(event) {
            event.preventDefault();
            
            const id = document.getElementById('order-id').value;
            const orderData = {
                id: id ? parseInt(id) : Date.now(),
                companyId: parseInt(document.getElementById('order-company').value),
                driverId: parseInt(document.getElementById('order-driver').value),
                date: document.getElementById('order-date').value,
                postcode: document.getElementById('order-postcode').value,
                customer: document.getElementById('order-customer').value,
                phone: document.getElementById('order-customer-phone').value,
                revenue: parseFloat(document.getElementById('order-revenue').value),
                status: document.getElementById('order-status').value,
                notes: document.getElementById('order-notes').value
            };
            
            if (id) {
                const index = orders.findIndex(o => o.id === parseInt(id));
                orders[index] = orderData;
            } else {
                orders.push(orderData);
            }
            
            localStorage.setItem('orders_pro', JSON.stringify(orders));
            closeOrderModal();
            loadOrders();
            loadDashboard();
            alert('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­!');
        }

        function editOrder(id) {
            openOrderModal(id);
        }

        // Advance Modal Functions
        function openAdvanceModal(advanceId = null) {
            const modal = document.getElementById('advance-modal');
            const form = document.getElementById('advance-form');
            form.reset();
            
            // Populate driver dropdown
            const driverSelect = document.getElementById('advance-driver');
            driverSelect.innerHTML = '<option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ø³Ø§Ø¦Ù‚ --</option>' + 
                drivers.filter(d => d.status === 'active').map(d => 
                    `<option value="${d.id}">${d.name}</option>`
                ).join('');
            
            if (advanceId) {
                const advance = advances.find(a => a.id === advanceId);
                if (advance) {
                    document.getElementById('advance-modal-title').textContent = 'âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø³Ù„ÙØ©';
                    document.getElementById('advance-id').value = advance.id;
                    document.getElementById('advance-driver').value = advance.driverId;
                    document.getElementById('advance-amount').value = advance.amount;
                    document.getElementById('advance-date').value = advance.date;
                    document.getElementById('advance-payment-method').value = advance.paymentMethod;
                    document.getElementById('advance-reason').value = advance.reason || '';
                    
                    if (advance.paymentMethod === 'installments') {
                        document.getElementById('advance-installments').value = advance.installments || 4;
                        toggleInstallments();
                        calculateInstallmentAmount();
                    }
                }
            } else {
                document.getElementById('advance-modal-title').textContent = 'ğŸ’³ Ø¥Ø¶Ø§ÙØ© Ø³Ù„ÙØ© Ø¬Ø¯ÙŠØ¯Ø©';
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('advance-date').value = today;
            }
            
            modal.classList.add('active');
        }

        function closeAdvanceModal() {
            document.getElementById('advance-modal').classList.remove('active');
        }

        function toggleInstallments() {
            const method = document.getElementById('advance-payment-method').value;
            const installmentSection = document.getElementById('installment-section');
            const installmentAmountSection = document.getElementById('installment-amount-section');
            
            if (method === 'installments') {
                installmentSection.classList.remove('hidden');
                installmentAmountSection.classList.remove('hidden');
                calculateInstallmentAmount();
            } else {
                installmentSection.classList.add('hidden');
                installmentAmountSection.classList.add('hidden');
            }
        }

        function calculateInstallmentAmount() {
            const amount = parseFloat(document.getElementById('advance-amount').value) || 0;
            const installments = parseInt(document.getElementById('advance-installments').value) || 1;
            const installmentAmount = amount / installments;
            document.getElementById('advance-installment-amount').value = installmentAmount.toFixed(2);
        }

        function saveAdvance(event) {
            event.preventDefault();
            
            const id = document.getElementById('advance-id').value;
            const amount = parseFloat(document.getElementById('advance-amount').value);
            const paymentMethod = document.getElementById('advance-payment-method').value;
            
            const advanceData = {
                id: id ? parseInt(id) : Date.now(),
                driverId: parseInt(document.getElementById('advance-driver').value),
                amount: amount,
                remaining: amount,
                date: document.getElementById('advance-date').value,
                paymentMethod: paymentMethod,
                reason: document.getElementById('advance-reason').value,
                status: 'active'
            };
            
            if (paymentMethod === 'installments') {
                advanceData.installments = parseInt(document.getElementById('advance-installments').value);
                advanceData.installmentAmount = parseFloat(document.getElementById('advance-installment-amount').value);
            }
            
            if (id) {
                const index = advances.findIndex(a => a.id === parseInt(id));
                advances[index] = advanceData;
            } else {
                advances.push(advanceData);
            }
            
            localStorage.setItem('advances_pro', JSON.stringify(advances));
            closeAdvanceModal();
            loadAdvances();
            alert('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø³Ù„ÙØ© Ø¨Ù†Ø¬Ø§Ø­!');
        }
        
        // Initialize
        showPage('dashboard');
    </script>
</body>
</html>
